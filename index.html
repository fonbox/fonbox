<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>FonBox</title>
    <link rel="stylesheet" href="styles.css">
    <!-- instascan will scan QR codes -->
    <script type="text/javascript" src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
  </head>
  <body>
    <header class="App-header">
      <h1> FonBox </h1>
    </header>
    <h1> Hello, welcome to FonBox! </h1>
    <h2> Put your phone in the box to have fun! </h2>
    <h3> This app needs your camera and microphone access before the <em>fun times</em> begin </h3>
    <h4> For the best experience, use Safari on iPhone or Chrome on Android. </h4>
    <div class="img-div">
       <img src="https://raw.githubusercontent.com/mfekadu/coursera-test/master/site/img/very_nice.gif" alt="very nice gif borat">
    </div>
    <button class="primary_btn" id="showVideo">Open camera</button>
    <div id="errorMsg"></div>
    <video id="frontCam" autoplay playsinline></video>
    <div>
        <a href="https://github.com/fonbox/fonbox" id="viewSource">View source code on GitHub</a>
    </div>
  </body>
  <footer>
    <script type="text/javascript">
      // create new scanner and listen to the video element
      let scanner = new Instascan.Scanner({
        video: document.getElementById('frontCam'),
        refractoryPeriod: 1000, // scan every 1 second
      });
      scanner.addListener('scan', function (data, image) {
        console.log(data);
      });

      function openCamera(e) {
        Instascan.Camera.getCameras().then(function (cameras) {
          if (cameras.length > 0) {
            console.log('cameras');
            scanner.start(cameras[0]);
          } else {
            console.error('No cameras found.');
          }
        }).catch(function (e) {
          console.log('error'); // console.error(e);
        });

        e.target.disabled = true;
        console.log(e);
      }

      document.querySelector('#showVideo').addEventListener('click', e => openCamera(e));
    </script>
  </footer>
</html>
